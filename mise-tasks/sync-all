#!/usr/bin/env bash
#MISE description="Sync firmware and keymaps for all keyboards in keymaps file"

set -e

# Get unique keyboards from keymaps file (first column, skip comments/empty)
grep -v '^#' keymaps | grep -v '^//' | grep -v '^$' | awk '{print $1}' | sort -u | while read kb; do
  echo "=== $kb ==="
  mise run sync "$kb"
  echo ""
done

echo "All keyboards synced."
